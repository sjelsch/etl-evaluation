SELECT
  LO_ORDERDATEYEARLEVEL, LO_CUSTKEYNATIONLEVEL, SUM(LO_REVENUE) - sum(LO_SUPPLYCOST) AS PROFIT
FROM FACTS
INNER JOIN LO_ORDERDATE ON (FACTS.LO_ORDERDATE = LO_ORDERDATE.KEY)
INNER JOIN LO_CUSTKEY ON (FACTS.LO_CUSTKEY = LO_CUSTKEY.KEY)
INNER JOIN LO_SUPPKEY ON (FACTS.LO_SUPPKEY = LO_SUPPKEY.KEY)
INNER JOIN LO_PARTKEY ON (FACTS.LO_PARTKEY = LO_PARTKEY.KEY)
WHERE
  LO_CUSTKEYREGIONLEVEL = '<http://lod2.eu/schemas/rdfh#lo_custkeyRegionAMERICA>'
  AND LO_SUPPKEYREGIONLEVEL = '<http://lod2.eu/schemas/rdfh#lo_suppkeyRegionAMERICA>'
  AND (LO_PARTKEYMFGRLEVEL = '<http://lod2.eu/schemas/rdfh#lo_partkeyMfgrMFGR-1>' OR LO_PARTKEYMFGRLEVEL = '<http://lod2.eu/schemas/rdfh#lo_partkeyMfgrMFGR-2>')
GROUP BY
  LO_ORDERDATEYEARLEVEL, LO_CUSTKEYNATIONLEVEL
ORDER BY
  LO_ORDERDATEYEARLEVEL, LO_CUSTKEYNATIONLEVEL
