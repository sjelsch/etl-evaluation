SELECT
  LO_CUSTKEYCITYLEVEL, LO_SUPPKEYCITYLEVEL, LO_ORDERDATEYEARLEVEL, SUM(LO_REVENUE) AS LO_REVENUE
FROM FACTS
INNER JOIN LO_ORDERDATE ON (FACTS.LO_ORDERDATE = LO_ORDERDATE.KEY)
INNER JOIN LO_CUSTKEY ON (FACTS.LO_CUSTKEY = LO_CUSTKEY.KEY)
INNER JOIN LO_SUPPKEY ON (FACTS.LO_SUPPKEY = LO_SUPPKEY.KEY)
WHERE
  (LO_CUSTKEYCITYLEVEL='<http://lod2.eu/schemas/rdfh#lo_custkeyCityUNITED-KI1>' OR LO_CUSTKEYCITYLEVEL='<http://lod2.eu/schemas/rdfh#lo_custkeyCityUNITED-KI5>')
  AND (LO_SUPPKEYCITYLEVEL='<http://lod2.eu/schemas/rdfh#lo_suppkeyCityUNITED-KI1>' OR LO_SUPPKEYCITYLEVEL='<http://lod2.eu/schemas/rdfh#lo_suppkeyCityUNITED-KI5>')
  AND LO_ORDERDATEYEARMONTHLEVEL = '<http://lod2.eu/schemas/rdfh#lo_orderdateYearMonthDec1997>'
GROUP BY
  LO_CUSTKEYCITYLEVEL, LO_SUPPKEYCITYLEVEL, LO_ORDERDATEYEARLEVEL
ORDER BY
  LO_ORDERDATEYEARLEVEL ASC, LO_REVENUE DESC
