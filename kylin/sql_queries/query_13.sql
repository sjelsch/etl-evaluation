SELECT
  LO_ORDERDATEYEARLEVEL, LO_SUPPKEYCITYLEVEL, LO_PARTKEYBRAND1LEVEL,
  SUM(LO_REVENUE) - sum(LO_SUPPLYCOST) AS PROFIT
FROM FACTS
INNER JOIN LO_ORDERDATE ON (FACTS.LO_ORDERDATE = LO_ORDERDATE.KEY)
INNER JOIN LO_CUSTKEY ON (FACTS.LO_CUSTKEY = LO_CUSTKEY.KEY)
INNER JOIN LO_SUPPKEY ON (FACTS.LO_SUPPKEY = LO_SUPPKEY.KEY)
INNER JOIN LO_PARTKEY ON (FACTS.LO_PARTKEY = LO_PARTKEY.KEY)
WHERE
  LO_CUSTKEYREGIONLEVEL = '<http://lod2.eu/schemas/rdfh#lo_custkeyRegionAMERICA>'
  AND LO_SUPPKEYNATIONLEVEL = '<http://lod2.eu/schemas/rdfh#lo_suppkeyNationUNITED-STATES>'
  AND (LO_ORDERDATEYEARLEVEL = '<http://lod2.eu/schemas/rdfh#lo_orderdateYear1997>' OR LO_ORDERDATEYEARLEVEL = '<http://lod2.eu/schemas/rdfh#lo_orderdateYear1998>')
  AND LO_PARTKEYCATEGORYLEVEL = '<http://lod2.eu/schemas/rdfh#lo_partkeyCategoryMFGR-14>'
GROUP BY
  LO_ORDERDATEYEARLEVEL, LO_SUPPKEYCITYLEVEL, LO_PARTKEYBRAND1LEVEL
ORDER BY
  LO_ORDERDATEYEARLEVEL, LO_SUPPKEYCITYLEVEL, LO_PARTKEYBRAND1LEVEL
